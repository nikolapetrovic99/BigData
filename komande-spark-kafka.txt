
docker-compose up -d

u fajlu consumer_spark se pozicioniras i
docker build --rm -t bde/spark-app .

///docker run -it --name some-cassandra --link spark_master:spark_master -d turbineanalytics/sparkassandra-dockerized

docker run --name proj2 --net bde -p 4040:4040 -d bde/spark-app


CREATE TABLE average_duration (window_start TIMESTAMP, window_end TIMESTAMP, duration_avg DOUBLE,PRIMARY KEY ((window_start), window_end));
CREATE TABLE average_duration (window_start TIMESTAMP, window_end TIMESTAMP, duration_avg DOUBLE,PRIMARY KEY ((window_start), window_end));

CREATE TABLE average_duration (window_start TIMESTAMP, window_end TIMESTAMP, duration_avg DOUBLE,PRIMARY KEY ((window_start), window_end));
CREATE TABLE bikesdb.rides(Duration text,Start_date text,EndDate text,Start_station_number text,Start_station text,End_station_number text,End_station text, Bike_number text, Member_type text);
CREATE TABLE bikesdb.rides(Duration text,Start_date text,EndDate text,Start_station_number text,Start_station text,End_station_number text,End_station text, Bike_number text, Member_type text);
 
CREATE TABLE IF NOT EXISTS newkeyspace.sparktwo(start_station text, popularity_count bigint, start_date timestamp, end_date timestamp, PRIMARY KEY (start_station, start_date, end_date));


CREATE KEYSPACE newkeyspace WITH REPLICATION = {'class' : 'SimpleStrategy', 'replication_factor' : 1 };
CREATE KEYSPACE newkeyspace WITH REPLICATION = {'class' : 'SimpleStrategy', 'replication_factor' : 1 };
drop table newkeyspace.sparkone;
CREATE TABLE IF NOT EXISTS newkeyspace.sparkone (Start_station text, avg_duration double, min_duration text, max_duration text, start_station_count bigint, start_date timestamp, end_date timestamp, PRIMARY KEY (start_date, end_date));
CREATE TABLE IF NOT EXISTS newkeyspace.sparkone (avg_duration double, min_duration text, max_duration text, start
_station_count bigint, start_date timestamp, end_date timestamp, PRIMARY KEY (start_date, end_date));
CREATE TABLE newkeyspace.sparkOne(Start_station text, window text PRIMARY KEY, avg_duration double, min_duration double, max_duration double , start_station_count int);